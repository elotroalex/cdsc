desc 'Publishing the website via rsync and testing'

require 'colorize'
require 'html-proofer'

task :mock do
  puts 'First, let\'s build your site...'.green
  sh "jekyll build"
  puts "\n"
  puts 'Let\'s publish your site, hold on a sec...'.green
# personal server setup
  user = 'agil'
  server = 'elotroalex.com'
  path = '/home/agil/cdsc-dev.elotroalex.com/'
  sh "rsync -r -e \"ssh -p22\" _site/. #{user}@#{server}:#{path}"
  puts "\n"
  puts 'Bam! Your website is now published!'.green
  puts "\n"
end

task :prod do
  puts 'First, let\'s build your site...'.green
  sh "jekyll build"
  puts "\n"
  puts 'Let\'s publish your site, hold on a sec...'.green
# personal server setup
  user = ''
  server = ''
  path = ''
  sh "rsync -r -e \"ssh -p22\" _site/. #{user}@#{server}:#{path}"
  puts "\n"
  puts 'Bam! Your website is now published!'.green
  puts "\n"
end

task :test do
  puts 'Let\'s run some tests...'.green
  sh "bundle exec jekyll build"
  options = {
    :assume_extension => true,
    # :check_favicon => true,
    :check_html => true,
    # :external_only => true,
    # :disable_external => true,
    :allow_hash_href => true,
    :only_4xx => true
    }
  HTMLProofer.check_directory("./_site", options).run
end