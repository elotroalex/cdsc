<div class="container">
  <!-- Navigation Links for Micro-Grants -->
  <div class="program-navigation">
    <a href="#micro-grants-2025" class="btn btn-link">2025</a> |
    <a href="#micro-grants-2024" class="btn btn-link">2024</a> |
    <a href="#micro-grants-2023" class="btn btn-link">2023</a>
  </div>

  <div class="grantee-list">
    {% assign grouped_grants = site.data.grantees-microgrants | group_by: "program" %}

    {% for program in grouped_grants %}
      {% assign year = "" %}
      {% if program.name contains "2024-25" %}
        {% assign year = "2025" %}
      {% elsif program.name contains "2023-24" %}
        {% assign year = "2024" %}
      {% elsif program.name contains "2022-23" %}
        {% assign year = "2023" %}
      {% endif %}

      {% if year != "" %}
        <div id="micro-grants-{{ year }}" class="program-group">
          <h2 class="program-title mt-5">Micro-Grants {{ year }}</h2>
          <div class="row">
            {% for grant in program.items %}
              <div class="col-12">
                <div class="grant-item mb-5 mt-5 row">
                  <!-- Image Column -->
                  <div class="col-2">
                    {% assign image_index = forloop.index0 | modulo: 2 %}
                    {% if image_index == 0 %}
                      <img src="/assets/images/54.png" alt="Placeholder Image 1" class="img-fluid" />
                    {% else %}
                      <img src="/assets/images/55.png" alt="Placeholder Image 2" class="img-fluid" />
                    {% endif %}
                  </div>

                  <!-- Text Column -->
                  <div class="col-9">
                    <h4 class="mb-0">{{ grant["Project Title"] }}</h4>
                    <p class="m-0 pt-3">{{ grant["PI(s)"] }}</p>
                    <p class="mt-0 small-text">{{ grant["Location of project"] }} | {{ grant["Amount awarded"] }}</p>
                    <div class="description">
                      <p class="mt-3 mb-0 collapse-content">
                        {% if site.active_lang == 'es' %}
                          {{ grant.description_esp }}
                        {% elsif site.active_lang == 'fr' %}
                          {{ grant.description_fr }}
                        {% else %}
                          {{ grant.description_en }}
                        {% endif %}
                      </p>
                      <div class="view-more-link mt-0" style="display: none;">
                        {% if grant["External links"] and grant["External links"] != "N/A" %}
                          <a href="{{ grant["External links"] | strip }}" target="_blank" class="btn btn-link px-0">Visit project page</a>
                        {% endif %}
                      </div>
                      <a href="#" class="toggle-description mt-4 btn btn-program">See more</a>
                    </div>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
</div>






<!-- CSS -->
<style>
  .collapse-content {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .description.expanded .collapse-content {
    display: block;
    -webkit-line-clamp: unset;
    -webkit-box-orient: unset;
    overflow: visible;
  }
</style>

<!-- JavaScript -->
<script>
  document.querySelectorAll('.toggle-description').forEach(toggle => {
    toggle.addEventListener('click', function (event) {
      event.preventDefault();

      const description = this.closest('.description');
      const collapseContent = description.querySelector('.collapse-content');
      const viewMoreLink = description.querySelector('.view-more-link');

      if (description.classList.contains('expanded')) {
        // Collapse content
        description.classList.remove('expanded');
        this.textContent = 'See more';
        collapseContent.style.display = '-webkit-box'; // Reapply truncation
        if (viewMoreLink) viewMoreLink.style.display = 'none'; // Hide link
      } else {
        // Expand content
        description.classList.add('expanded');
        this.textContent = 'See less';
        collapseContent.style.display = 'block'; // Show full content
        if (viewMoreLink) viewMoreLink.style.display = 'block'; // Show link
      }
    });
  });
</script>
